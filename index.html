<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Just for Phishing ‚Äî Interactive Phishing Awareness</title>
  <style>
    :root{--bg:#0e3940;--card:#0b2c31;--muted:#bfe4e2;--ink:#eaf7f6;--accent:#11b8c7;--accent-2:#8bd14f;--success:#22c55e;--danger:#ef4444;--glass:rgba(255,255,255,0.08)}
    *{box-sizing:border-box}
    body{font-family:Inter, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial; background:linear-gradient(180deg,#0b3338 0%, #08282d 70%); color:var(--ink); margin:0; padding:24px}
    .wrap{max-width:980px;margin:0 auto}
    header{display:flex;align-items:center;gap:16px;margin-bottom:18px}
    .logo{width:96px;height:96px;border-radius:16px;object-fit:contain;display:block}
    h1{margin:0;font-size:20px}
    p.lead{color:var(--muted);margin:6px 0 18px}

    .card{background:var(--card);padding:18px;border-radius:12px;box-shadow:0 6px 18px rgba(2,6,23,0.6);margin-bottom:16px}
    .flex{display:flex;gap:12px}
    .spacer{flex:1}

    .progress{height:14px;background:var(--glass);border-radius:999px;overflow:hidden}
    .progress > i{display:block;height:100%;background:linear-gradient(90deg,var(--accent),var(--accent-2));width:0%}

    .levels{display:grid;grid-template-columns:repeat(3,1fr);gap:10px;margin-top:12px}
    .level-btn{background:transparent;border:1px solid rgba(191,228,226,0.25);padding:12px;border-radius:12px;text-align:center;cursor:pointer;color:var(--muted)}
    .level-btn.locked{opacity:.45}

    .game-area{min-height:260px}
    .email{background:#0c3035;border:1px solid rgba(191,228,226,0.26);padding:16px;border-radius:12px;font-size:15px;line-height:1.55}
    .email .from{font-weight:600;color:#cfeefe}
    .email .subject{font-weight:700;margin-top:6px}
    .choices{display:flex;flex-direction:column;gap:8px;margin-top:12px}
    .choice{padding:12px;border-radius:10px;background:rgba(191,228,226,0.08);cursor:pointer;border:1px solid rgba(0,0,0,0.2)}
    .choice:hover{transform:translateY(-2px)}

    footer{margin-top:16px;color:var(--muted);font-size:13px}

    .row{display:flex;gap:12px;align-items:center}
    input[type=text]{padding:8px;border-radius:8px;border:1px solid rgba(191,228,226,0.35);background:transparent;color:inherit}
    button{background:var(--accent);border:none;padding:10px 12px;border-radius:10px;color:#002a2e;font-weight:700;cursor:pointer;transition:.15s transform}
    button:hover{transform:translateY(-1px)}
    button.secondary{background:transparent;border:1px solid rgba(191,228,226,0.35);color:var(--muted)}

    .badge{display:inline-block;padding:6px 8px;border-radius:999px;background:rgba(191,228,226,0.15);color:var(--muted);font-weight:600}

    .certificate{padding:20px;background:linear-gradient(180deg,#fff,#f3f4f6);color:#07202a;border-radius:10px}
    .certificate h2{margin:0}
    .hidden{display:none}

    /* High contrast mode */
    body.hc{background:#000 !important;color:#fff}
    body.hc .card{background:#0c0c0c}
    body.hc .email{background:#0a0a0a;border-color:#444}
    body.hc .choice{background:#111;border-color:#555}
    body.hc .level-btn{border-color:#666}
    body.hc .badge{background:#1a1a1a;color:#eaeaea}

    /* Intro grid with large logo */
    #intro .intro-grid{display:grid;grid-template-columns:min(32%,280px) 1fr;gap:16px;align-items:center}
    #intro .intro-logo{display:flex;align-items:center;justify-content:center}
    #intro .intro-logo img{width:100%;max-width:320px;height:auto;display:block;border-radius:16px;background:rgba(255,255,255,0.06);padding:12px}
    @media (max-width:760px){#intro .intro-grid{grid-template-columns:1fr} #intro .intro-logo img{max-width:240px;margin:0 auto}}

    @media (max-width:760px){.levels{grid-template-columns:repeat(2,1fr)}body{padding:12px}}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <img class="logo" src="assets/JustforPhishingLogo.png" alt="Just for Phishing logo" onerror="this.style.display='none'" />
      <div>
        <h1>Just for Phishing ‚Äî Interactive Phishing Awareness</h1>
        <p class="lead">Learn to spot phishing with short levels, instant feedback, and a printable certificate for your technology leader.</p>
      </div>
      <div class="spacer"></div>
      <div class="card" style="min-width:280px;padding:10px;display:flex;flex-direction:column;gap:8px;align-items:flex-end">
        <div class="row" style="width:100%">
          <div class="badge">Level <span id="current-level">1</span></div>
          <div style="flex:1"></div>
          <button id="reviewBtn" class="secondary" title="Review your answers" style="padding:6px 8px;font-size:12px">Review</button>
          <div class="badge">Points <b id="points">0</b></div>
        </div>
        <div class="progress" aria-hidden="true"><i id="progress-bar"></i></div>
        <div class="row" style="justify-content:flex-end">
          <label style="font-size:12px;color:var(--muted);display:flex;align-items:center;gap:6px"><input id="hcToggle" type="checkbox"/> High contrast</label>
        </div>
      </div>
    </header>

    <main>
      <section class="card">
        <div style="display:flex;align-items:center;justify-content:space-between">
          <strong>Levels</strong>
          <small style="color:var(--muted)">Complete levels to unlock the certificate</small>
        </div>
        <div class="levels" id="levels"></div>
      </section>

      <section class="card game-area" id="game-area">
        <div id="intro">
          <div class="intro-grid">
            <div class="intro-logo"><img src="assets/JustforPhishingLogo.png" alt="Just for Phishing logo large"/></div>
            <div class="intro-copy">
              <h3>Welcome!</h3>
              <p style="color:var(--muted)">Start with Level 1: Spot the red flags in a suspicious email. As you answer, you'll earn points and unlock more practice levels. This demo stores progress in your browser (no accounts).</p>
              <div style="margin-top:10px;display:flex;gap:8px;flex-wrap:wrap">
                <button id="startBtn">Start Level 1</button>
                <button class="secondary" id="resetBtn">Reset Progress</button>
              </div>
            </div>
          </div>
        </div>
      </section>

      <section class="card hidden" id="review-area">
        <div class="row" style="align-items:center;justify-content:space-between">
          <strong>Review Answers</strong>
          <button class="secondary" id="clearReview">Clear</button>
        </div>
        <div id="reviewList" style="margin-top:10px"></div>
      </section>

      <section class="card hidden" id="certificate-area">
        <div class="row" style="align-items:center;justify-content:space-between;margin-bottom:10px">
          <strong>Certificate</strong>
          <div class="row">
            <input id="certName" type="text" placeholder="Your full name" style="min-width:220px" />
            <button id="printCert">Print / Save</button>
          </div>
        </div>
        <div id="certificatePreview" class="certificate">
          <h2 style="text-align:center">Phishing Awareness Certificate</h2>
          <p style="text-align:center;margin-top:8px;">This certifies that</p>
          <h3 id="certPreviewName" style="text-align:center;margin:6px 0">[Name]</h3>
          <p style="text-align:center;margin-top:4px;color:#333">has successfully completed the Just for Phishing training and demonstrated foundational phishing awareness skills.</p>
          <div style="display:flex;justify-content:space-between;margin-top:18px">
            <div>
              <div style="font-weight:700">Points</div>
              <div id="certPoints">0</div>
            </div>
            <div style="text-align:right">
              <div style="font-weight:700">Date</div>
              <div id="certDate"></div>
            </div>
          </div>
          <p id="certSummary" style="text-align:center;margin-top:12px;font-weight:600"></p>
        </div>
      </section>

    </main>

    <footer>
      <small>Built for education ‚Äî certificate unlocks only after all levels are finished.</small>
    </footer>
  </div>

  <script>
    // ================= App Data =================
    const LEVELS = [
      {id:1,title:'Email Red Flags',desc:'Find what makes this email suspicious',score:100},
      {id:2,title:'Inspect the Link',desc:'Identify safe vs suspicious URLs',score:120},
      {id:3,title:'Attachments & Downloads',desc:'Decide safe handling for attachments',score:120},
      {id:4,title:'Social Engineering',desc:'Spot the manipulation tactics',score:140},
      {id:5,title:'Report & Respond',desc:'Practice reporting and clean up',score:160}
    ];

    const BANK = {
      1: [
        {id:'1a',from:'IT Support <itsupport@yourbank.com>',subject:'URGENT: Verify your account',body:'We detected unusual activity. Click here to verify your credentials: http://yourbank.verify-account.com',choices:[
          {text:'Mark as phishing ‚Äî contains urgent language + suspicious link',correct:true,explain:'Correct ‚Äî urgent language + domain mismatch are red flags.'},
          {text:'Safe ‚Äî it looks like my bank',correct:false,explain:'The domain is not your bank domain and contains extra words.'},
          {text:'Forward to friends',correct:false,explain:'Don\'t forward; this spreads risk.'}
        ]},
        {id:'1b',from:'HR <hr@company.example>',subject:'üéÅ Congratulations, pick your reward',body:'Please sign in with your password to claim your gift card.',choices:[
          {text:'Report ‚Äî unexpected reward request',correct:true,explain:'Unsolicited rewards that ask you to sign in are a red flag.'},
          {text:'Sign in ‚Äî it\'s from HR',correct:false,explain:'Sender name can be spoofed; verify via another channel.'}
        ]}
      ],
      2: [
        {id:'2a',url:'http://apple-secure-id.com/login',question:'Is this URL safe?',choices:[
          {text:'Not safe ‚Äî domain looks crafted to mimic Apple',correct:true,explain:'Right ‚Äî lookalike domain.'},
          {text:'Safe ‚Äî it has apple in the url',correct:false,explain:'Domain name tricks are common.'}
        ]},
        {id:'2b',url:'https://intranet.yourcompany.local/dashboard',question:'Is this likely safe when on the corporate VPN?',choices:[
          {text:'Likely safe (internal host)',correct:true,explain:'Internal hostnames can be safe when on your network.'},
          {text:'Not safe',correct:false,explain:'If not connected to VPN, this would not resolve.'}
        ]}
      ],
      3: [
        {id:'3a',att:'invoice.pdf.exe',question:'This download is named "invoice.pdf.exe". What should you do?',choices:[
          {text:'Do not open; report to security',correct:true,explain:'Correct ‚Äî double extensions are a trick.'},
          {text:'Open it ‚Äî it\'s a PDF',correct:false,explain:'Actually it\'s an executable; the .exe at the end is dangerous.'}
        ]}
      ],
      4: [
        {id:'4a',scenario:'A manager asks you to buy gift cards ASAP and send photos of the codes.',question:'How do you respond?',choices:[
          {text:'Verify in person or by phone before acting',correct:true,explain:'Always verify with the requester using a known channel.'},
          {text:'Purchase and send ‚Äî it seems urgent',correct:false,explain:'This is a classic business email compromise pattern.'}
        ]}
      ],
      5: [
        {id:'5a',scenario:'You clicked a link and think you may have given a password.',question:'Next step?',choices:[
          {text:'Change password immediately and notify IT',correct:true,explain:'Correct ‚Äî mitigate quickly.'},
          {text:'Wait and see',correct:false,explain:'Waiting risks further compromise.'}
        ]}
      ]
    };

    // ================= State =================
    let state = {level:1,points:0,completed:[],currentQuestion:null,history:[],hc:false};

    // Load/save
    function loadState(){
      try{ const s=JSON.parse(localStorage.getItem('phishplay')); if(s) state=Object.assign(state,s); }catch(e){}
      document.body.classList.toggle('hc',!!state.hc);
      document.getElementById('hcToggle').checked=!!state.hc;
      updateUI();
    }
    function saveState(){ localStorage.setItem('phishplay',JSON.stringify(state)); }

    // Build levels UI
    const levelsEl=document.getElementById('levels');
    LEVELS.forEach(l=>{
      const btn=document.createElement('button');
      btn.className='level-btn'; btn.id='lvl-'+l.id;
      btn.innerHTML=`<strong>Level ${l.id}</strong><div style="font-size:13px;color:var(--muted)">${l.title}</div>`;
      btn.onclick=()=>startLevel(l.id);
      levelsEl.appendChild(btn);
    });

    function updateUI(){
      document.getElementById('current-level').textContent=state.level;
      document.getElementById('points').textContent=state.points;
      const prog=Math.min(100,Math.round((state.completed.length/LEVELS.length)*100));
      document.getElementById('progress-bar').style.width=prog+'%';

      LEVELS.forEach(l=>{
        const el=document.getElementById('lvl-'+l.id);
        if(state.completed.includes(l.id)) el.style.opacity=.6;
        if(l.id<=state.completed.length+1) el.classList.remove('locked'); else el.classList.add('locked');
      });

      document.getElementById('certificate-area').classList.toggle('hidden',!(state.completed.length>=LEVELS.length));
      document.getElementById('review-area').classList.toggle('hidden', state.history.length===0);
    }

    // High contrast toggle
    document.getElementById('hcToggle').addEventListener('change',(e)=>{
      state.hc=!!e.target.checked; document.body.classList.toggle('hc',state.hc); saveState();
    });

    // Review button
    document.getElementById('reviewBtn').addEventListener('click',()=>{
      renderReview();
      document.getElementById('review-area').classList.remove('hidden');
      window.scrollTo({top:document.getElementById('review-area').offsetTop-12,behavior:'smooth'});
    });
    document.getElementById('clearReview').addEventListener('click',()=>{
      if(confirm('Clear saved answers?')){ state.history=[]; saveState(); renderReview(); updateUI(); }
    });

    // Intro controls
    document.getElementById('startBtn').addEventListener('click',()=>startLevel(1));
    document.getElementById('resetBtn').addEventListener('click',()=>{
      if(confirm('Reset progress?')){
        state={level:1,points:0,completed:[],currentQuestion:null,history:[],hc:state.hc};
        saveState(); updateUI(); renderIntro();
      }
    });

    function renderIntro(){
      const area=document.getElementById('game-area');
      area.innerHTML=`<div id=\"intro\"><div class=\"intro-grid\"><div class=\"intro-logo\"><img src=\"assets/JustforPhishingLogo.png\" alt=\"Just for Phishing logo large\"/></div><div class=\"intro-copy\"><h3>Welcome!</h3><p style=\\"color:var(--muted)\\">Start with Level 1: Spot the red flags in a suspicious email. As you answer, you'll earn points and unlock more practice levels. This demo stores progress in your browser (no accounts).</p><div style=\\"margin-top:10px;display:flex;gap:8px;flex-wrap:wrap\\"><button id=\\"startBtn\\">Start Level 1<\\/button><button class=\\"secondary\\" id=\\"resetBtn\\">Reset Progress<\\/button><\\/div><\\/div><\\/div><\\/div>`;
      document.getElementById('startBtn').addEventListener('click',()=>startLevel(1));
      document.getElementById('resetBtn').addEventListener('click',()=>{
        if(confirm('Reset progress?')){ state={level:1,points:0,completed:[],currentQuestion:null,history:[],hc:state.hc}; saveState(); updateUI(); renderIntro(); }
      });
    }

    function startLevel(id){
      if(id>state.completed.length+1){alert('Finish earlier levels first.');return;}
      state.level=id; saveState(); updateUI(); renderLevel(id);
    }

    function renderLevel(id){
      const area=document.getElementById('game-area'); area.innerHTML='';
      const level=LEVELS.find(l=>l.id===id);
      const title=document.createElement('div');
      title.innerHTML=`<h3>Level ${level.id}: ${level.title}</h3><p style=\"color:var(--muted)\">${level.desc}</p>`;
      area.appendChild(title);
      const items=BANK[id]; if(!items){area.innerHTML+='<p>No questions yet.</p>';return;}
      const q=items[Math.floor(Math.random()*items.length)]; state.currentQuestion=q; saveState();

      if(q.from){
        const email=document.createElement('div'); email.className='email';
        email.innerHTML=`<div class=\"from\">${q.from}</div><div class=\"subject\">${q.subject}</div><div style=\"margin-top:8px;color:var(--muted)\">${q.body}</div>`;
        area.appendChild(email);
      } else if(q.url){
        area.innerHTML+=`<div style=\"margin-top:8px;color:var(--muted)\"><strong>URL:</strong> ${q.url}</div>`;
      } else if(q.scenario){
        area.innerHTML+=`<div style=\"margin-top:8px;color:var(--muted)\">${q.scenario}</div>`;
      }

      const choices=document.createElement('div'); choices.className='choices';
      q.choices.forEach(c=>{
        const ch=document.createElement('div'); ch.className='choice'; ch.textContent=c.text; ch.onclick=()=>answerChoice(q,c);
        choices.appendChild(ch);
      }); area.appendChild(choices);
    }

    function answerChoice(q,choice){
      const feedback=document.createElement('div'); feedback.style.marginTop='12px';
      if(choice.correct){
        feedback.style.color='var(--success)'; feedback.textContent='‚úÖ '+choice.explain; state.points+=20;
      } else {
        feedback.style.color='var(--danger)'; feedback.textContent='‚ùå '+choice.explain;
      }
      document.querySelector('.game-area').appendChild(feedback);

      // store in review history
      state.history.push({
        level: state.level,
        id: q.id||'q',
        prompt: q.subject? q.subject : (q.question||q.scenario||q.url||'Question'),
        choice: choice.text,
        correct: !!choice.correct,
        explain: choice.explain
      });

      saveState(); updateUI();
      setTimeout(()=>{
        if(!state.completed.includes(state.level)) state.completed.push(state.level);
        saveState(); updateUI();
        if(state.completed.length>=LEVELS.length){ showCertificateReady(); }
        else if(state.level < LEVELS.length){
          if(confirm('Level complete! Move to next level?')) startLevel(state.level+1); else renderIntro();
        }
      },900);
    }

    function renderReview(){
      const list=document.getElementById('reviewList');
      if(state.history.length===0){ list.innerHTML='<p style="color:var(--muted)">No answers yet.</p>'; return; }
      list.innerHTML = state.history.map((h,i)=>{
        const tag = h.correct ? '‚úÖ' : '‚ùå';
        return `<div style="border:1px solid rgba(191,228,226,0.35);border-radius:10px;padding:10px;margin:8px 0;background:rgba(191,228,226,0.08)">
          <div style="font-weight:700">L${h.level} ¬∑ ${escapeHtml(h.prompt)}</div>
          <div style="margin-top:6px">${tag} <em>${escapeHtml(h.choice)}</em></div>
          <div style="color:var(--muted);margin-top:6px">${escapeHtml(h.explain)}</div>
        </div>`;
      }).join('');
    }

    function showCertificateReady(){
      document.getElementById('certPoints').textContent=state.points;
      document.getElementById('certDate').textContent=new Date().toLocaleDateString();
      document.getElementById('certSummary').textContent = `Completed Levels: ${state.completed.length}/${LEVELS.length}`;
      document.getElementById('certificate-area').classList.remove('hidden');
      renderReview();
    }

    // Certificate print (with small summary)
    document.getElementById('printCert').addEventListener('click',()=>{
      const name=document.getElementById('certName').value.trim()||'Name';
      document.getElementById('certPreviewName').textContent=name;
      const completed = `${state.completed.length}/${LEVELS.length}`;
      const html = `<!doctype html><html><head><meta charset=\"utf-8\"><meta name=\"viewport\" content=\"width=device-width,initial-scale=1\"><title>Certificate</title><style>body{font-family:Inter,Arial;color:#07202a;padding:40px;background:#fff;margin:0} .cert{border:6px solid #11b8c7;padding:36px;border-radius:12px;max-width:900px;margin:0 auto} h1,h2{margin:0 0 8px 0}</style></head><body><div class='cert'><h1 style='text-align:center'>Phishing Awareness Certificate</h1><p style='text-align:center'>This certifies that</p><h2 style='text-align:center'>${escapeHtml(name)}</h2><p style='text-align:center'>has completed the Just for Phishing interactive phishing awareness training.</p><div style='display:flex;justify-content:space-between;margin-top:24px'><div>Points: ${state.points}</div><div>Date: ${new Date().toLocaleDateString()}</div></div><p style='text-align:center;margin-top:12px;font-weight:700'>Completed Levels: ${completed}</p><script>window.onload=function(){setTimeout(function(){window.print()},300)}<\/script></div></body></html>`;
      const w=window.open('','_blank'); if(!w){alert('Pop-up blocked: allow pop-ups to print your certificate.');return;} w.document.open(); w.document.write(html); w.document.close();
    });

    function escapeHtml(s){ return String(s).replace(/[&<>\"]/g, c=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;'}[c])); }

    // Init
    loadState();
    if(state.completed.length>=LEVELS.length) showCertificateReady();
  </script>
</body>
</html>
